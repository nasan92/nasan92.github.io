<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>InfrastructureAsCode - Tag - NASAN</title><link>https://nasan92.github.io/tags/infrastructureascode/</link><description>InfrastructureAsCode - Tag - NASAN</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 23 Sep 2023 06:10:21 +0100</lastBuildDate><atom:link href="https://nasan92.github.io/tags/infrastructureascode/" rel="self" type="application/rss+xml"/><item><title>Setting up Azure DevOps to deploy Azure Resources with Terraform using Workload Identity Federation (2 Part Series)</title><link>https://nasan92.github.io/posts/2023-09-23-azuredevopsterraform/</link><pubDate>Sat, 23 Sep 2023 06:10:21 +0100</pubDate><author>Author</author><guid>https://nasan92.github.io/posts/2023-09-23-azuredevopsterraform/</guid><description><![CDATA[I was curious about how to set up Azure DevOps to utilize Terraform for deploying Azure resources with workload identity federation instead of relying on a service principal with secrets. In this blog post, I will demonstrate how I set up this configuration.
To learn more about workload identity federation read the docs:
Workload identity federation - Microsoft Entra | Microsoft Learn
Prerequisites Azure DevOps Org &ldquo;Customer Azure Tenant&rdquo; with Subscription &ldquo;Backend Azure Tenant&rdquo; with Subscription (can be in the same tenant - in our example we use different tenants) Azure Powershell Module Overview - Setup Steps Create a storage account that will store the Terraform state file Create a managed identity which has contributor permissions on this storage account If not already the case, install the Terraform extension for your Azure DevOps Org Create a new Azure DevOps Project Create a service connection to the &ldquo;backend tenant&rdquo; using workload identity federation with your previously created managed identity Create a managed identity in the customer tenant where you finally want to deploy Azure Resources using Terraform, with Contributor permission on the Subscription Create a service connection to the customer tenant using workload identity federation with your previously created managed identity Create a repository with basic Terraform files Create an Azure DevOps Pipeline Preview Prepare &ldquo;Backend Tenant&rdquo; to store Terraform State File As outlined in this example, I intend to store the Terraform state file in a different Azure Tenant than where the actual Azure Deployment will occur.]]></description></item></channel></rss>